---
title: "Project"
author: "Harika"
date: "04/12/2019"
output: html_document
---
```{r}
library(factoextra)
library(hrbrthemes)
library(GGally)
library(viridis)
```

Problem Statement:
CRISA has traditionally segmented markets on the basis of purchaser demographics. They would now like to segment the market based on two key sets of variables more directly related to the purchase process and to brand loyalty:
1. Purchase behavior (volume, frequency, susceptibility to discounts, and brand loyalty)
2. Basis of purchase (price, selling proposition)Doing so would allow CRISA to gain information about what demographic attributes are associated with different purchase behaviors and degrees of brand loyalty, and thus deploy promotion budgetsmore effectively. More effective market segmentation would enable CRISAâ€™s clients (in this case, a firm called IMRB)to design more cost-effective promotions targeted at appropriate segments. Thus, multiple promotions could be launched, each targeted at different market segments at different times of the year. This would result in a more cost-effective allocation of the promotion budget to different market segments. It would also enable IMRB to design more effective customer reward systems and thereby increase brand loyalty.

#Reading the data 
```{r}
data <- read.csv("BathSoap.csv")
mydata_norm <- as.data.frame(scale(data))
```

#Brand_Loyal is calculated by the maximum value of all eight brands and comparing with other999 brand.
```{r}
BrandLoyal<-data[,23:30]
Max_Brand<-apply(BrandLoyal, 1, max)
Max_Brand<-as.data.frame(Max_Brand)
BrandComp<-cbind(Max_Brand,data[,31])
MaxLoyal<-as.data.frame(ifelse(BrandComp[,1]>=BrandComp[,2],1,0))
MaxLoyalComp<-cbind(BrandComp,MaxLoyal)
BathSoapComp<-cbind(data,MaxLoyal)
names(BathSoapComp)[47] <- "Brand_Loyal"
```

#Purchase Behavior
Purchase behavior variables includes volume, frequency, susceptibility to discounts, and brand loyalty
```{r}
#Variable selection
data1 <- BathSoapComp[,c(12:22,47)]
data1 <- as.data.frame(scale(data1))

#k-means
set.seed(123)
fviz_nbclust(data1, kmeans, method = "wss")
data1_K3 <- kmeans(data1, centers =3 , nstart = 200) # k = 3

# Size and Center for the Clusters
data1_K3$size
data1_clusters <- data.frame(data1_K3$centers)
cluster <- matrix(c("1","2","3"),nrow = 3)
data1.visual <- cbind(cluster,data1_clusters)

#Cluster visiualization 
fviz_cluster(data1_K3, data = data1)

#Parallel Plot
ggparcoord(data1.visual,
    columns = 2:13, groupColumn = 1, 
    showPoints = TRUE, 
    title = "Parallel Plot for Purchase Behaviour Data",
    alphaLines = 0.3
    ) 

```

#Basis of purchase
Basis of purchase (price, selling proposition)
```{r}

data2 <- BathSoapComp[,c(32:46)]
data2 <- data.frame(scale(data2))

set.seed(123)
data2_k3 <- kmeans(data2, centers =3 , nstart = 500)

# Size and Center for the Clusters
data2_k3$size
data2_clusters <- data.frame(data2_k3$centers)
cluster <- matrix(c("1","2","3"),nrow = 3)
data2.visual <- cbind(cluster,data1_clusters)

#cluster visualization
fviz_cluster(data2_k3, data = data2)

#Parallel Plot
ggparcoord(data1.visual,
    columns = 2:13, groupColumn = 1, 
    showPoints = TRUE, 
    title = "Parallel Plot for Basis of PUrchase",
    alphaLines = 0.3
    ) 

```
The variables that describe both purchase behavior and basis of purchase

```{r}

data3 <- BathSoapComp[,c(12:22,32:46,47)]
data3 <- data.frame(scale(data3))

#k-means
set.seed(123)
fviz_nbclust(data3, kmeans, method = "wss")

set.seed(123)
data3_k3 <- kmeans(data3, centers =3 , nstart = 500) 

# Size and Center for the Clusters
data3_k3$size
data3_clusters <- data.frame(data3_k3$centers)
cluster <- matrix(c("1","2","3"),nrow = 3)
data3.visual <- cbind(cluster,data3_clusters)

#cluster visualization
fviz_cluster(data3_k3, data = data3)

#Parallel Plot
ggparcoord(data3.visual,
    columns = 2:13, groupColumn = 1, 
    showPoints = TRUE, 
    title = "Parallel Plot for Purchase Behavior and Basis of PUrchase",
    alphaLines = 0.3
    ) 
```


```{r}

```

```{r}

```

```{r}

```






